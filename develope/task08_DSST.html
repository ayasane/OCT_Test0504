<!DOCTYPE html>
<html>
<head>
    <script src="src/jspsych-6.1.0/jspsych.js"></script>
    <script src="src/jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="src/jspsych-6.1.0/plugins/jspsych-html-button-response.js"></script>
    <script src="src/jspsych-6.1.0/plugins/jspsych-fullscreen.js"></script>
    <link rel="stylesheet" href="src/jspsych-6.1.0/css/jspsych.css"></link>
</head>

<body>
    <script type="text/javascript">

      /* 課題に関するコードを以下に書く */
      var fullscreen = {
        type: 'fullscreen',
        message: '<p>以下のボタンをクリックすると，画面は全画面表示に切り替わります。全画面表示を止めたい場合はEscキーを押してください。</p>',
        button_label: "全画面表示に切り替え",
        fullscreen_mode: true
      };
      var instruction = {
        type: 'html-button-response',
        stimulus: '<p>画面の下側には，9つの記号が並んで表示されます。<br>\
                   画面上の青い四角枠の中に，この9種の記号のどれか一つがランダムに表示されます。<br>\
                　 画面に現れる記号と同じ記号を選んでボタンを押してください。ボタンを押すと次の記号が現れます。<br>\
                   できるだけ素早く正確に，画面に現れる記号と同じ記号のボタンを押して反応し続けてください。</p>',
        choices: ['NEXT'],
        prompt: 'NEXTボタンを押すと，練習問題に移ります。'
      };

      var s1 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli01.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '1'
      }
      var s2 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli02.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '2'
      }
      var s3 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli03.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '3'
      }
      var s4 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli04.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '4'
      }
      var s5 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli05.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '5'
      }
      var s6 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli06.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '6'
      }
      var s7 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli07.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '7'
      }
      var s8 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli08.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '8'
      }
      var s9 = {
        stimulus: '<div style="position: absolute; top: 30%; left: 50%"><img src="img/task08_DSST/stimuli09.png" width="100px" border="2" style="border-color: #42f5da"/></div>',
        correct_response: '9'
      }

      var stimulus_arr = [s1,s2,s3,s4,s5,s6,s7,s8,s9];
      var repetation = 1;
      var all_stim = jsPsych.randomization.repeat(stimulus_arr, repetation);
      console.log(all_stim);
      // warming up
      var thread_warmingup = {
        timeline: [{
            type: "html-button-response",
            stimulus: jsPsych.timelineVariable('stimulus'),
            correct_response: jsPsych.timelineVariable('correct_response'),
            choices: [
                '<div style="position: absolute; top: 80%; left: 10%"><img src="img/task08_DSST/stimuli01.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 20%"><img src="img/task08_DSST/stimuli02.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 30%"><img src="img/task08_DSST/stimuli03.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 40%"><img src="img/task08_DSST/stimuli04.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 50%"><img src="img/task08_DSST/stimuli05.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 60%"><img src="img/task08_DSST/stimuli06.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 70%"><img src="img/task08_DSST/stimuli07.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 80%"><img src="img/task08_DSST/stimuli08.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 90%"><img src="img/task08_DSST/stimuli09.png"/></div>',
            ],
            button_html: '%choice%',
            on_finish: function(data){
                console.log(data.button_pressed);
                console.log(data.correct_response);
                if(data.button_pressed==data.correct_response){
                    data.correct = true;
                } else {
                    data.correct = false;
                }
            }
        }],
        timeline_variables: all_stim,
      };

      var interval = {
        type: 'html-button-response',
        stimulus: '<p>練習問題はここまでです。<br>\
                   次の画面から，本番です。<br>\
                   できるだけ素早く，画面に現れる記号と同じ記号を選んでボタンを押してください。</p>',
        choices: ['NEXT'],
        prompt: 'NEXTボタンを押すと，本番に移ります。'
      };

      // test
      var repetation = 10;
      var all_stim = jsPsych.randomization.repeat(stimulus_arr, repetation);
      console.log(all_stim);
      var thread = {
        timeline: [{
            type: "html-button-response",
            stimulus: jsPsych.timelineVariable('stimulus'),
            correct_response: jsPsych.timelineVariable('correct_response'),
            choices: [
                '<div style="position: absolute; top: 80%; left: 10%"><img src="img/task08_DSST/stimuli01.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 20%"><img src="img/task08_DSST/stimuli02.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 30%"><img src="img/task08_DSST/stimuli03.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 40%"><img src="img/task08_DSST/stimuli04.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 50%"><img src="img/task08_DSST/stimuli05.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 60%"><img src="img/task08_DSST/stimuli06.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 70%"><img src="img/task08_DSST/stimuli07.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 80%"><img src="img/task08_DSST/stimuli08.png"/></div>',
                '<div style="position: absolute; top: 80%; left: 90%"><img src="img/task08_DSST/stimuli09.png"/></div>',
            ],
            button_html: '%choice%',
            on_finish: function(data){
                console.log(data.button_pressed);
                console.log(data.correct_response);
                if(data.button_pressed==data.correct_response){
                    data.correct = true;
                } else {
                    data.correct = false;
                }
            }
        }],
        timeline_variables: all_stim,
      };

      /* タイムラインの設定 */
      var timeline = [];
      timeline.push(fullscreen);
      timeline.push(instruction);
      timeline.push(thread_warmingup);
      timeline.push(interval);
      timeline.push(thread);

      /* 課題開始 */
      jsPsych.init({
        timeline: timeline,
        on_finish: function() {
          jsPsych.data.displayData();
        }
      });
      
    </script>
</body>
</html>


